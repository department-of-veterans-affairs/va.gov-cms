id: news_spotlight_blocks
label: 'Custom Block Migration from https://news.va.gov'
migration_group: va_gov
langcode: en
source:
  track_changes: true
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: json
  urls:
    - 'https://news.va.gov//wp-json/wp/v2/posts?categories=18505'
  item_selector: ''
  fields:
    -
      name: id
      label: 'Unique identifier'
      selector: id
    -
      name: changed
      label: Last changed date in the GMT timezone represented in ISO 8601 format
      selector: modified_gmt
    -
      name: status
      label: Published status
      selector: status
    -
      name: headline
      label: Promo headline
      selector: title/rendered
    -
      name: excerpt
      label: Promo text
      selector: excerpt/rendered #needs html stripped
    -
      name: link
      label: Link
      selector: link
    -
      name: image
      label: Image
      selector: meta_box/vagov_featured_image/sizes/medium/url
    -
      name: image_alt_text
      label: Image alt text
      selector: meta_box/featured_image_alt_text
    -
  ids:
    id:
      type: string
  constants:
    - LINK_TEXT: 'Read the full article'
    - MEDIA_SECTION: 1109
    - PROMO_SECTION: 6
process:
  info: headline
  field_promo_headline: headline
  field_promo_text: excerpt
  field_link: link
  type:
    plugin: default_value
    default_value: news_promo
  moderation_state:
    plugin: default_value
    default_value: published
#
#  # Generate media entity for the image
#  field_media_image:
#    plugin: 'entity_generate'
#    entity_type: 'media'
#    bundle: 'image'
#    value_key: 'field_media_image'
#    url: 'media:thumbnail'
#    alt: 'media:description'
#    title: 'title'  # Optional, you can use the title for the image title
#
#  field_image_alt_text: 'media:description'
#  field_published_date: 'pubDate'
destination:
  plugin: 'entity:block_content'

migration_dependencies:
  required: []
  optional: []
