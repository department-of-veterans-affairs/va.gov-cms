# #######################################################################
# New Vet Center Facility Runbook #
# #######################################################################
# Runbook for adding new Vet Center Facilities tickets.
# Created and last edited by Stefanie Gray - stefanie.gray@va.gov
# #######################################################################
name: Flagged Facilities ticket form - New Vet Center Facility / Section
description: Use this form to create a new ticket listing the runbook steps for creating and publishing new Vet Center Facilities (and Sections) in the CMS.
title: New Vet Center Facility/Section - [INSERT VET CENTER NAME]
labels: Change request, Drupal engineering, Facilities, Flagged Facilities, User support, Vet Center, sitewide
projects: projects/1859

body:

  # MARKDOWN WITH MULTI-LINE CONTENT:
  - type: markdown
    attributes:
      value: |
       ### Before creating a New Vet Center Facility ticket
       - Please do not create this ticket until the new Vet Center has appeared on the CMS [Flagged Facilities page](https://prod.cms.va.gov/admin/content/facilities/flagged) **or** until either the Facilities team or VA Leadership have instructed us to create the new Vet Center homepage and section.
       
       - **If notified via Jira but not flagged in the CMS:** Confirm with the editor that they reported the new facility to VAST. Please refer to the KB article "[How do I update my Vet Center facility's basic location data?](https://prod.cms.va.gov/help/vet-centers/how-do-i-update-my-vet-center-facilitys-basic-location-data)" for more info and send to editor if needed.
       
       - **If reported to VAST but not listed yet:** Changes made within VAST can take up to 75 days to appear within the Facilities API.
       
       - **If the help desk is waiting on info or actions from facility editor(s):** Please add the "Awaiting editor" flag to the facility node with a revision log message that includes Jira or Github ticket numbers. Do not change the moderation state of the node (e.g. "Draft", "Published") when adding or removing flags unless otherwise noted.
       
       - **To find out which content editors should be assigned to this Vet Center:**  Contact Barb Kuhn or the current Vet Centers VA point of contact once the new section has been created.
       
       ----------

  # MARKDOWN WITH MULTI-LINE CONTENT:
  - type: markdown
    attributes:
      value: |
        # Facility and ticket information

  # INPUT:
  - type: input
    id: vet_center_facility
    attributes:
      label: Vet Center facility name
      description: "What is the full, official name of the new Vet Center facility?"
      placeholder: "Example: Cityname Vet Center"
    validations:
      required: true

  # INPUT:
  - type: input
    id: vet_center_section
    attributes:
      label: New Vet Center section name
      description: "What is the name of the new Vet Center section that should be created in the CMS Sections taxonomy?"
      placeholder: "Example: Cityname Vet Center"
    validations:
      required: true

  # INPUT:
  - type: input
    id: facility_prod_link
    attributes:
      label: Link to facility on production site
      description: "Please provide a link to the facility on the VA CMS production site once it becomes available."
      placeholder: "https://prod.cms.va.gov..."
    validations:
      required: false

  # INPUT:
  - type: input
    id: facility_api_id
    attributes:
      label: Facility API ID
      description: "What is the facility's API ID? (If available.)"
      placeholder: "e.g. vha_123AZ"
    validations:
      required: false

  # CHECKBOX:
  - type: checkboxes
    id: spreadsheet
    attributes:
      label: Has the new Vet Center been added to the internal Flagged Facilities listing yet?
      description: If no, please add it to the appropriate tab with the prod link, facility ID, and any relevant ticket links or details. ([Current spreadsheet](https://docs.google.com/spreadsheets/d/1mqTRGkrnfysFMjC8xTHdFzQOMIQ7WrD2CLX83io5Z74/edit?gid=1358772674#gid=1358772674))
      options:
        - label: "Yes"
        - label: "No"
    validations:
      required: false

  # TEXTAREA:
  - type: textarea
    id: jira_ticket_links
    attributes:
      label: Embedded Support - Please link Jira ticket(s) associated with facility.
      description: "Paste one or more links to relevant VA CMS tickets in Jira. If none found, please link any new Jira tickets once created."
      placeholder: |
        1. https://jira.example.com/browse/ABC-123
        2. https://jira.example.com/browse/ABC-456
    validations:
      required: false

  # TEXTAREA:
  - type: textarea
    id: runbook_steps
    attributes:
      label: Acceptance criteria for new Vet Center facilities (Runbook steps)
      description: LEAVE AS-IS, SKIP TO "CREATE." Assignees will check off the boxes below as they complete the work.
      value: |
        ### Drupal Administrator steps (Embedded Support team or Facilities team):

        #### STEP 1: Verify new section approval
        - [ ] Please verify with the Facilities Team and/or VA Leadership that the new Vet Center is approved to become a new section within the CMS.
              - Information may be provided within existing Jira tickets. Please compile all information and cross-link all tickets. You may also link to Slack threads within the comments of this ticket.

        #### STEP 2: Verify new Vet Center district and points of contact
        - [ ] Confirm the new Vet Center's district (1, 2, 3, 4, 5) and log the name and email address of the Vet Center Director and Outreach Specialist, if applicable, within internal notes.

        ------

        ### Facilities team steps:

        #### STEP 3: Add new section
        - [ ] Complete the following steps to add the new Vet Center section to the Sections taxonomy and assign it to the correct district.

              Path: `/admin/structure/taxonomy/manage/administration/overview`

              - Product: "Vet Center."
              - The name of the Vet Center is required but the "Description" field can be left blank.
              - Under "Relations" the parent term should be the District (i.e. District 1).
              - Click "Save."

        #### STEP 4: Create new "Locations List" node
        - [ ] From "Content -> Add Content" create a new "Vet Center - Locations List" node, assign it to the newly created Section, and save it as a Draft.

        ------

        ### Embedded Support team steps:

        #### STEP 5: Review new homepage and section
        - [ ] Double-check all URL aliases, breadcrumbs, and menu links for new Vet Center and section and report any issues to Facilities engineers.

        #### STEP 6: Create Vet Center editor accounts
        - [ ] Create new CMS accounts assigned to the new Vet Center section for the associated editors. If you do not know who should be assigned to this facility, please contact Barb Kuhn, Vet Centers VA leadership, or the Facilities team.

        #### STEP 7: Ask editor to add necessary homepage elements
        Link to Vet Center Editor Guide, if needed for content editors: `https://prod.cms.va.gov/help/vet-centers/vet-center-editor-guide`

        - [ ] Send "Vet Center homepage edits needed" email to associated content editors (see Email Templates section at bottom of ticket).

        #### STEP 8: Verify homepage elements
        Please make sure the new Vet Center homepage has the following list added before publishing day:

        - [ ] A facility photo
        - [ ] Vet Center services
        - [ ] "Prepare For Your Visit" information
        - [ ] Satellite locations, if applicable (optional)

        You may need to follow up with the associated editor(s) using the "Vet Center follow-up reminder" email template provided below.

        #### STEP 9: Publishing day -- bulk publishing all linked nodes
        - [ ] Go to the Bulk Edit page (`admin/content/bulk`), filter by the new Vet Center section name, moderation state = "Any".
        - [ ] Select all nodes, then scroll to the "Action" menu at the bottom of the Bulk Edit page.
        - [ ] Click "Publish latest revision" then click "Apply to selected items."
        - [ ] After bulk-publishing, double-check all linked Vet Center nodes to ensure that they've successfully published.

        #### STEP 10: After the next content release goes out
        - [ ] Verify that the URL for the new Vet Center is working on the live site and that associated nodes such as the "Locations" page and any satellite locations are linked properly.

        ------

        ### Embedded Support team steps (Continued):

        #### STEP 11: Remove flag
        - [ ] Go to the main Vet Center homepage, click "Edit," then scroll to bottom to remove the `New facility` flag and any other flags. Click Save.

        #### STEP 12: Wrap-up editor comms
        - [ ] Help Desk team informs content editors and/or Barb Kuhn that process is complete.

        ------
    validations:
      required: true

  # EMAIL TEMPLATES:
  - type: textarea
    id: email_templates
    attributes:
      label: Email templates
      description: Leave this section as-is. Assignees will copy email templates from here.
      value: |
        ### New Vet Center reported
        Send if a new Vet Center has been reported via the Flagged Facilities page but there is no existing communication confirming that this Vet Center vehicle is in use:

        ```
        A new Vet Center, [NAME OF VET CENTER], has been added to the VA.gov CMS.

        The Facility ID associated with it is: [INSERT VET CENTER ID]

        For your convenience, here is a direct link to this node: [INSERT PRODUCTION URL FOR Vet Center NODE]

        Please confirm whether this information is correct, and please let our team know whether an opening date has been determined. Thank you!

        This node is currently saved as a “Draft” and the info is not yet visible on the live site. Before the new Vet Center homepage is published, it will need Vet Center services, "Prepare For Your Visit" info, and a facility info.

        For more information about required details, please see the following Knowledge Base article: https://prod.cms.va.gov/help/vet-centers/vet-center-editor-guide
        ```

        ### Vet Center homepage edits needed
        Send if the Vet Center's content editors have not added Vet Center Services, a photo, "Prepare For Your Visit" info, and/or satellite locations (optional) to the homepage before opening day.

        ```
        Hello! Before the new [INSERT NAME OF VET CENTER] homepage can be published to the live site, there is information that must be added within the CMS:

        Please add:
        - Vet Center Services
        - A facility photo
        - "Prepare For Your Visit" information
        - Satellite locations such as Mobile Vet Centers or Outstations, if applicable (Optional)

        For assistance, please refer to the Vet Center Editor Guide in the CMS Knowledge Base (We recommend bookmarking this page for future reference!): https://prod.cms.va.gov/help/vet-centers/vet-center-editor-guide

        For your convenience, here is a direct link to this node: [INSERT PRODUCTION URL FOR Vet Center NODE]
        ```

        ### Vet Center follow-up reminder
        Send if the Vet Center's content editors require a second reminder to add Vet Center Services, a photo, "Prepare For Your Visit" info, and/or satellite locations (optional) to the homepage before opening day.

        ```
        Hello! The new [INSERT NAME OF VET CENTER] will be opening on [OPENING DATE]. However, the homepage is still missing some crucial components that are necessary for Veterans accessing care at this location.

        Please add:
        - Vet Center Services
        - A facility photo
        - "Prepare For Your Visit" information
        - Satellite locations such as Mobile Vet Centers or Outstations, if applicable (Optional)

        For assistance, please refer to the Vet Center Editor Guide in the CMS Knowledge Base (We recommend bookmarking this page for future reference!): https://prod.cms.va.gov/help/vet-centers/vet-center-editor-guide

        For your convenience, here is a direct link to this node: [INSERT PRODUCTION URL FOR Vet Center NODE]
        ```
    validations:
      required: true
