# Downstream Dependencies

## Background

This document lists known services which depend on the CMS. Information on **API Users** for some downstream dependencies can be found [here](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/drupal_api_users.md).

## Services

| ServiceName                                                                  | Monitoring                                                                                                                                                                                                                                                                                                                                                                                                                                  | Mode                                                                                                                                                                                                                                                                                                          | Data                                                                                                                               | Alerts                    | Team POC                    | API Username                    | GQL Downstream integartion                    |
|------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------|---------------------------|---------------------------|---------------------------|---------------------------|
| Forms API                                                                    | [Datadog](https://vagov.ddog-gov.com/synthetics/details/f83-ca6-cu2)                                                                                                                                                                                                                                                                                                                                                                         | Lighthouse pulls data with GraphQL ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/migrations-forms.md#cms-forms-data-to-lighthouse))                                                                                                                              | form data (manually edited auxiliary fields) from “VA Form” nodes                                                                  | Pager Duty - Non Critical | [#va-forms](https://dsva.slack.com/archives/CUB5X5MGF) | forms_api | Nightly Frequency (0100 ET) Forms API = form data (manually edited auxiliary fields) from “VA Form” nodes ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/migrations-forms.md#cms-forms-data-to-lighthouse))
| [GraphQL (Content API)](#graphql-content-api-notes)                          | [Datadog](https://vagov.ddog-gov.com/synthetics/details/f83-ca6-cu2)                                                                                                                                                                                                                                                                                                                                                                         | GraphQL contrib module provides endpoint and explorer ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/graph_ql.md))                                                                                                                                                | All Drupal entities (content & config)                                                                                             | Pager Duty - Non Critical | Slack [#vsp-tools-fe](https://dsva.slack.com/archives/CQH357ZTP) | content_build_api | Hourly frequency 8am-5pm ET for Content build
| Facility Statuses (push to lighthouse)                                       | Slack notification to `#cms-notifications` channel via Drupal [here](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/docroot/modules/custom/va_gov_post_api/src/EventSubscriber/QueueItemProcessedEventSubscriber.php#L104) and [here](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/docroot/modules/custom/va_gov_post_api/src/EventSubscriber/QueueProcessedEventSubscriber.php#L107) | post_api contrib module is used to POST updates to lighthouse’s API every 10-15 minutes (when updates are available in queue) ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/vamc-facilities.md#status-changes-to-lighthouse))                                    | Facility statuses (certain fields on VAMC statuses, operating status, additional status info, facility API locator ID used as GID) | Slack                     | Slack [#vsa-facilities](https://dsva.slack.com/archives/C0FQSS30V) | facility_api | N/A
| Health service descriptions                                                  | Slack notification to `#cms-notifications` channel via Drupal [here](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/docroot/modules/custom/va_gov_post_api/src/EventSubscriber/QueueItemProcessedEventSubscriber.php#L104) and [here](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/docroot/modules/custom/va_gov_post_api/src/EventSubscriber/QueueProcessedEventSubscriber.php#L107) | post_api contrib module is used to POST updates to the Lighthouse API on cron every 10-15 minutes (when updates are available in queue) ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/vamc-facilities.md#status-changes-to-lighthouse))                          | Only Covid 19 vaccine service descriptions at this time, but soon to be all health service descriptions.                           | Slack                     | N/A | N/A  | N/A
| Post content release webhook endpoint (Content Build calls after content releases) | [Datadog](https://vagov.ddog-gov.com/synthetics/details/qam-6i3-t5c)                                                                                                                                                                                                                                                                                                                                                                         | Webhook endpoint (GET) at /api/govdelivery_bulletins/queue - used to trigger sending of notifications to govdelivery. Gov Delivery code is in the [va_gov_govdevivery](https://github.com/department-of-veterans-affairs/va.gov-cms/tree/main/docroot/modules/custom/va_gov_govdelivery)                    | `?EndTime=` of last successful GQL content query                                                                                   | None                      | | N/A | N/A
| Feature flags endpoint (/flags_list)                                         | [Datadog](https://vagov.ddog-gov.com/synthetics/details/9z4-5uh-k7r)                                                                                                                                                                                                                                                                                                                                                                         | GET endpoint at `/flags_list` that provides a list of feature flags for the content build (https://github.com/department-of-veterans-affairs/content-build/actions/workflows/content-release.yml) to consume ([README](https://github.com/department-of-veterans-affairs/va.gov-cms/blob/main/READMES/interfaces.md#featureflags)) | Feature flags that control whether certain products are enabled                                                                    | None                      | N/A | N/A | N/A
| Virtual Agent Chatbot                                        | N/A                                                                                                                                                                                                                                                                                                                                                                         | N/A | N/A | N/A | Slack [#va-virtual-agent-public](https://dsva.slack.com/archives/C01KTS3F493) | virtual_agent_api | Currently pulls from tugboat: https://main-0jm2a1h08xb0nzpger8iko49kskarwcm.ci.cms.va.gov/graphql
| Datadog Monitoring Platform                                        |                                                                                                                                                                                                            | Datadog uses Synthetic metrics to monitor GQL endpoints with authenticated HTTP requests. | N/A | N/A | Slack [#cms-platform](https://dsva.slack.com/archives/C02HX4AQZ33) | datadog_api |


